<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>PS Care ‚Äì Association de Magie</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="lib/bootstrap.min.css">
    <link rel="stylesheet" href="css/site.css">
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="css/inline-fix.css">
    <link rel="stylesheet" href="css/extra-fix.css">
    <link rel="stylesheet" href="css/table-fix.css">
    <style>
    /* Agrandir les boutons Devis dans la section Tarifs */
    .btn-devis-mailto.btn-devis-fix {
        font-size: 1.1rem !important;
        padding: 0.5rem 1.2rem !important;
        border-radius: 1rem !important;
        min-width: 100px;
        min-height: 38px;
    }
    /* Taille fixe r√©duite pour les images du carousel */
    .carousel-img {
        max-height: 600px !important;
        height: 600px !important;
        width: 1000px !important;
        object-fit: cover;
        display: inline-block;
    }
    /* Table responsive fix */
    .table-responsive { overflow-x: auto; }
    .table { min-width: 600px; }
    </style>
</head>
<body>
    <div class="avatar-tw" id="avatarTW">TW</div>
    <div class="avatar-menu" id="avatarMenu">
        <button id="btnLogout">D√©connexion</button>
        <button id="btnStats">Stats</button>
    </div>
    <nav class="navbar navbar-expand-lg navbar-dark bg-magic fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#accueil">Association Magic Ps Care</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Menu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mainNavbar">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="#accueil">Accueil</a></li>
                    <li class="nav-item"><a class="nav-link" href="#prestations">Prestations</a></li>
                    <li class="nav-item"><a class="nav-link" href="photographie.html">Photographie</a></li>
                    <li class="nav-item"><a class="nav-link" href="#tarifs" id="navDevisLink">Devis</a></li>
                    <li class="nav-item"><a class="nav-link" href="login.html" id="navLoginBtn">login</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <header id="accueil" class="hero-section hero-section-fix d-flex align-items-center justify-content-center text-center">
        <div class="container">
            <h1 class="display-3 display-3-fix mb-3"><span class="magic-title">Association Magic PS Care</span></h1>
            <p class="lead mb-4 lead-magic-fix">
                L‚Äôassociation qui fait vivre la magie √† travers spectacles, ateliers et solidarit√©.
            </p>
            <a href="#prestations" class="btn btn-magic btn-lg btn-zoom-anim btn-magic-fix" id="btnScrollPrestations">D√©couvrir nos Prestations</a>
        </div>
    </header>
 <div id="carouselPrestations" class="mt-5 carousel-prestations-fix">
    <div id="carousel-track" class="carousel-inner carousel-track-fix">
        <img src="https://i.pinimg.com/736x/a6/1b/52/a61b52c07066d079cdb260a90a1fbfbf.jpg" class="carousel-img rounded-3" alt="Prestation 1">
        <img src="https://i.pinimg.com/736x/76/9d/97/769d97d4113cff2d401105a0736e5e13.jpg" class="carousel-img rounded-3" alt="Prestation 2">
        <img src="https://i.pinimg.com/736x/f5/d5/28/f5d528d47b221fab98883d8b8fdc2d58.jpg" class="carousel-img rounded-3" alt="Prestation 3">
        <img src="https://i.pinimg.com/736x/a3/28/5d/a3285d950deecdfc0cd47553de684af0.jpg" class="carousel-img rounded-3" alt="Prestation 4">
        <img src="https://i.pinimg.com/736x/73/31/c0/7331c0cd6276934dac322ae1a60f67e6.jpg" class="carousel-img rounded-3" alt="Prestation 4">
    </div>
</div>
<script>
// Carrousel horizontal fluide et infini fa√ßon "vid√©o"
(function() {
    const track = document.getElementById('carousel-track');
    const images = Array.from(track.querySelectorAll('img'));
    const imgCount = images.length;
    // On duplique toutes les images pour la boucle infinie
    images.forEach(img => {
        track.appendChild(img.cloneNode(true));
    });

    // Calcul de la largeur totale des images originales + gap
    function getTotalWidth() {
        let total = 0;
        images.forEach(img => {
            total += img.offsetWidth;
        });
        // Ajouter les gaps (gap * (imgCount - 1))
        const gap = 16;
        total += gap * (imgCount - 1);
        return total;
    }

    let position = 0;
    const speed = 1.2; // pixels par frame

    function animate() {
        position += speed;
        track.style.transform = `translateX(-${position}px)`;
        const totalWidth = getTotalWidth();
        if (position >= totalWidth) {
            track.style.transition = 'none';
            position = 0;
            track.style.transform = `translateX(0)`;
            // Forcer le reflow pour r√©activer la transition
            void track.offsetWidth;
            track.style.transition = 'none';
        }
        requestAnimationFrame(animate);
    }

    // D√©sactive la transition CSS pour un effet vid√©o parfaitement fluide
    track.style.transition = 'none';
    // Attendre que les images soient charg√©es pour avoir la bonne largeur
    window.addEventListener('load', animate);
})();
</script>
    <section id="projets" class="section py-5">
        <div class="container">
            <h2 class="section-title mb-4">Qui Sommes Nous ? </h2>
            <p class="lead mb-4">
                L‚ÄôAssociation Magic PS Care est bien plus qu‚Äôun collectif artistique‚ÄØ; c‚Äôest une aventure humaine d√©di√©e √† l‚Äô√©veil et √† la stimulation des sens et des esprits. Ancr√©e dans la tradition associative loi 1901 et bas√©e au Pradet, notre dynamique repose sur une conviction profonde : la magie a le pouvoir de transformer des vies. Notre initiative, baptis√©e "Magic Effects On Spirit", s‚Äôadresse autant aux enfants hospitalis√©s, aux jeunes √©voluant dans les maisons de l‚Äôenfance, qu‚Äôaux personnes √¢g√©es en domicile ou en EHPAD. Nous utilisons le langage universel de la magie pour insuffler sourire, curiosit√© et vitalit√© l√† o√π le quotidien exige une dose suppl√©mentaire d‚Äôespoir et de r√©confort.
            </p>
            <p>
                √Ä travers des interventions diversifi√©es ‚Äì des ateliers close up intimistes aux spectacles narratifs et immersifs ‚Äì nous ≈ìuvrons √† √©veiller, maintenir et d√©velopper les capacit√©s cognitives et cr√©atives de nos publics. Chaque rencontre est con√ßue pour favoriser la m√©moire, la concentration, la r√©flexion et l‚Äô√©merveillement, tout en cr√©ant un espace d‚Äô√©changes et de convivialit√©. Que ce soit lors d‚Äôun atelier d‚Äôapprentissage personnalis√© ou d‚Äôun spectacle grand public tel que ‚ÄúCr√©puscule Magique 2025‚Äù, nous pla√ßons l‚Äô√©motion et le partage au c≈ìur de notre approche.
            </p>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card bg-dark bg-opacity-75 border-0 h-100">
                        <div class="card-body">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="prestations" class="section py-5">
        <div class="container">
            <h2 class="section-title mb-4">Nos Prestations Magiques</h2>
            <!-- Ajout de la modale personnalis√©e -->
            <!-- Modale Devis actualis√©e -->
<div id="devisModal">
    <div id="devisModalContent">
        <div class="devisModal-inner">
            <button id="closeDevisModal">&times;</button>
            <div class="devis-prestation-label">Choisissez votre prestation :</div>
            <label for="prestationSelect" class="visually-hidden">Choisissez votre prestation</label>
            <select id="prestationSelect" title="Choisissez votre prestation">
                <option value="Atelier Close-Up et Apprentissage">Atelier Close-Up et Apprentissage (groupe 10 pers, 45min-1h, apprentissage tours, cadeau, spectacle fin d'ann√©e)</option>
                <option value="Atelier close up dans les chambres/services">Atelier close up dans les chambres/services (15-30min, apprentissage, plaisir, petits patients)</option>
                <option value="Spectacle de Magie CREPUSCULE MAGIQUE 2025">Spectacle de Magie CREPUSCULE MAGIQUE 2025 (10-15 pers, 1h-1h15, histoire, musique, univers magique)</option>
                <option value="Spectacle magie EHPAD et +">Spectacle magie EHPAD et + (270‚Ç¨)</option>
                <option value="Club magie EHPAD">Club magie EHPAD (150‚Ç¨)</option>
                <option value="Spectacle magie Priv√© adulte/enfant">Spectacle magie Priv√© adulte/enfant (200‚Ç¨ minimum)</option>
                <option value="Mariage et √©v√©nements sp√©ciaux">Mariage et √©v√©nements sp√©ciaux (prix sur devis)</option>
            </select>
            <div class="devis-send-label">Envoyer votre demande via :</div>
            <a id="gmailDevisBtn" href="#" target="_blank" class="devis-btn-gmail">Gmail</a>
            <a id="outlookDevisBtn" href="#" target="_blank" class="devis-btn-outlook">Outlook</a>
        </div>
    </div>
    <div class="devisModal-bg"></div>
</div>
            <div class="table-responsive">
                <table class="table table-bordered align-middle text-center bg-dark bg-opacity-75 text-light table-fixed">
                    <thead>
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="vertical-top-fix">
                                <br><span class="highlight-bg"><span class="arrow-red">‚Æï</span> <span class="texte-rouge">Atelier Close-Up et Apprentissage</span></span>
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Groupe maximum de 10 personnes
                                <br>
                                <br><span class="arrow-red">‚Æï</span> 45 minutes √† 1h00 
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Histoire de la magie / comment susciter l‚Äôint√©r√™t d‚Äôun public
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Close-up par le magicien Ted Winter pour √©veiller l‚Äôint√©r√™t
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Apprentissage d‚Äô1 ou 2 tours
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Plusieurs modules de tours en fonction du public
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Suivi de l‚Äôapprentissage / r√©p√©tition / club de magie
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Petit cadeau du tour √† chaque participant
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Spectacle en fin d‚Äôann√©e des participants
                                <br>
                            </td>
                            <td class="vertical-top-fix">
                                <br><span class="highlight-bg"><span class="arrow-red">‚Æï</span> <span class="texte-rouge">Atelier close up dans les chambres/services</span></span>
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Chambres des petits patients ou dans les services
                                <br>
                                <br><span class="arrow-red">‚Æï</span> 15 √† 30 minutes
                                <br>
                                <br><span class="arrow-red">‚Æï</span> close up par le magicien Ted Winter pour √©veiller l‚Äôint√©r√™t et apporter du plaisir
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Apprentissage d‚Äô1 ou 2 tours
                                <br>
                            </td>
                            <td class="vertical-top-fix">
                                <br><span class="highlight-bg"><span class="arrow-red">‚Æï</span> <span class="texte-rouge">Spectacle de Magie CREPUSCULE MAGIQUE 2025</span></span>
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Groupe 10-15 personnes
                                <br>
                                <br><span class="arrow-red">‚Æï</span> 1h00 √† 1h15
                                <br>
                                <br>Spectacle de magie par le magicien Ted Winter
                                <br>
                                <br><span class="arrow-red">‚Æï</span> histoire en pr√©ambule au tour / 2-3 tours sur la m√™me histoire
                                <br>
                                <br><span class="arrow-red">‚Æï</span> fond musical pour √©veiller l‚Äôint√©r√™t du public !
                                <br>
                                <br><span class="arrow-red">‚Æï</span> r√¥le d‚Äôacteur et de conteur
                                <br>
                                <br><span class="arrow-red">‚Æï</span> le tour de magie devient un pr√©texte pour cr√©er un univers magique
                                <br>
                                <br><span class="arrow-red">‚Æï</span> Plusieurs styles de spectacles en fonction du public (enfants/adultes)
                                <br>
                            </td>
                        </tr>
                        <!-- Nouvelle ligne pour les boutons Devis align√©s -->
                        <tr>
                            <td>
                                <div class="devis-btn-container">
                                    <!-- Le bouton "Devis" ne change pas de page, il ouvre seulement la modale d‚Äôemail -->
                                    <a href="#" class="btn btn-devis devis-btn-fix" type="button" onclick="openMailChoice(1, '', event)">Devis</a>
                                </div>
                            </td>
                            <td>
                                <div class="devis-btn-container">
                                    <!-- Le bouton "Devis" ne change pas de page, il ouvre seulement la modale d‚Äôemail -->
                                    <a href="#" class="btn btn-devis devis-btn-fix" type="button" onclick="openMailChoice(2, '', event)">Devis</a>
                                </div>
                            </td>
                            <td>
                                <div class="devis-btn-container">
                                    <!-- Le bouton "Devis" ne change pas de page, il ouvre seulement la modale d‚Äôemail -->
                                    <a href="#" class="btn btn-devis devis-btn-fix" type="button" onclick="openMailChoice(3, '', event)">Devis</a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <link rel="stylesheet" href="css/devis-fix.css">
    <style>
      /* Modale avis professionnelle */
      #avisModal {
        display: none;
        position: fixed;
        z-index: 3000;
        left: 0; top: 0;
        width: 100vw; height: 100vh;
        background: rgba(24,20,44,0.92);
        align-items: center;
        justify-content: center;
        animation: avis-fadein 0.3s;
      }
      @keyframes avis-fadein {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      .avis-modal-content {
        background: linear-gradient(135deg, #fff 0%, #f7e7ff 100%);
        border-radius: 1.5rem;
        box-shadow: 0 8px 32px #7c4dff55, 0 2px 8px #0002;
        max-width: 410px;
        width: 96%;
        margin: auto;
        padding: 2.2rem 1.5rem 1.5rem 1.5rem;
        position: relative;
        animation: avis-popin 0.4s cubic-bezier(.4,2,.6,1);
        display: flex;
        flex-direction: column;
        align-items: stretch;
      }
      @keyframes avis-popin {
        0% { transform: scale(0.85); opacity: 0; }
        100% { transform: scale(1); opacity: 1; }
      }
      .avis-modal-header {
        text-align: center;
        margin-bottom: 1.2rem;
      }
      .avis-modal-icon {
        width: 48px;
        height: 48px;
        margin-bottom: 0.3rem;
        filter: drop-shadow(0 2px 8px #ffd70088);
      }
      .avis-modal-header h2 {
        font-size: 1.6rem;
        color: #7c4dff;
        font-family: 'Cinzel Decorative', serif;
        margin-bottom: 0.2rem;
        letter-spacing: 1px;
      }
      .avis-modal-subtitle {
        font-size: 1.05rem;
        color: #381a5a;
        margin-bottom: 0.2rem;
        font-weight: 500;
      }
      .avis-close-btn {
        position: absolute;
        top: 14px; right: 18px;
        background: none;
        border: none;
        font-size: 2rem;
        color: #7c4dff;
        cursor: pointer;
        transition: color 0.2s;
        z-index: 10;
      }
      .avis-close-btn:hover {
        color: #ff2d2d;
      }
      .avis-form-row {
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
        margin-bottom: 0.7rem;
      }
      .avis-label {
        font-weight: bold;
        color: #2d1a3a;
        font-size: 1.08rem;
        margin-bottom: 0.1rem;
      }
      .avis-input, .avis-textarea {
        background: #f3eaff;
        border: 1.5px solid #7c4dff;
        color: #2d1a3a;
        border-radius: 0.7rem;
        padding: 0.5rem 0.9rem;
        font-size: 1.05rem;
        margin-bottom: 0.1rem;
        transition: border 0.2s, box-shadow 0.2s;
        /* Ajout pour forcer la couleur du texte lors de la saisie */
        caret-color: #181c2b;
      }
      .avis-input:focus, .avis-textarea:focus {
        border-color: #ffd700;
        box-shadow: 0 0 0 2px #ffd70044;
        outline: none;
        background: #fff;
        color: #181c2b; /* Texte noir lors de la saisie */
      }
      .avis-textarea {
        min-height: 60px;
        resize: vertical;
      }
      .avis-btn {
        margin-top: 0.5rem;
        width: 100%;
        font-size: 1.15rem !important;
        border-radius: 1.2rem;
        box-shadow: 0 2px 12px #ffd70033;
        font-weight: bold;
        letter-spacing: 1px;
      }
      .star-rating {
        font-size: 2rem;
        color: #ffd700;
        cursor: pointer;
        -webkit-user-select: none;
        user-select: none;
        margin-bottom: 0.1rem;
      }
      .star-rating .star {
        transition: color 0.2s, transform 0.15s;
        display: inline-block;
        margin-right: 2px;
      }
      .star-rating .star.inactive {
        color: #e0dcdc;
      }
      .star-rating .star:hover,
      .star-rating .star:focus {
        color: #ff2d2d;
        transform: scale(1.18);
      }
      #moyenneStars {
        font-size: 1.3rem;
        color: #ff9800;
        font-weight: bold;
        background: #fffbe7;
        border-radius: 0.7rem;
        padding: 0.7rem 0.5rem 0.5rem 0.5rem;
        margin-top: 0.7rem;
        box-shadow: 0 2px 8px #ffd70022;
      }
      @media (max-width: 575px) {
        .avis-modal-content {
          padding: 1.2rem 0.5rem 1rem 0.5rem;
        }
        .avis-modal-header h2 {
          font-size: 1.15rem;
        }
        .avis-modal-icon {
          width: 36px; height: 36px;
        }
      }
    </style>
    <div class="container my-5" id="tarifs">
        <h2 class="section-title mb-4 text-center">Tarifs des prestations de l'association ann√©e 2025</h2>
        <div class="tarifs-border-fix">
            <div class="row g-4">
                <div class="col-12 col-md-3">
                    <div class="card h-100 text-center">
                        <div class="card-body">
                            <h3 class="card-title">
                                Tarifs spectacle magie EHPAD et + <span class="card-title-red">270‚Ç¨</span>
                                <button class="btn btn-devis-mailto btn-zoom-anim btn-devis-fix"
                                    type="button"
                                    data-mail-subject="Demande de devis pour spectacle magie EHPAD et +"
                                    onclick="openMailChoice(3, this.getAttribute('data-mail-subject'), event)">
                                    Devis
                                </button>
                            </h3>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="card h-100 text-center">
                        <div class="card-body">
                            <h3 class="card-title">
                                Tarifs club magie EHPAD <span class="card-title-red">150‚Ç¨</span>
                                <button class="btn btn-devis-mailto btn-zoom-anim btn-devis-fix"
                                    type="button"
                                    data-mail-subject="Demande de devis pour club magie EHPAD"
                                    onclick="openMailChoice(3, this.getAttribute('data-mail-subject'), event)">
                                    Devis
                                </button>
                            </h3>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="card h-100 text-center">
                        <div class="card-body">
                            <h3 class="card-title">
                                Tarifs spectacle magie Priv√© adulte/enfant Minimum <span class="card-title-red">200‚Ç¨</span>
                                <button class="btn btn-devis-mailto btn-zoom-anim btn-devis-fix"
                                    type="button"
                                    data-mail-subject="Demande de devis pour spectacle magie Priv√© adulte/enfant"
                                    onclick="openMailChoice(3, this.getAttribute('data-mail-subject'), event)">
                                    Devis
                                </button>
                            </h3>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="card h-100 text-center">
                        <div class="card-body">
                            <span class="card-title-red">Devis pour mariage et √©v√©nements sp√©ciaux (prix vari√©e)</span>
                            <button class="btn btn-devis-mailto btn-zoom-anim btn-devis-fix"
                                type="button"
                                data-mail-subject="Demande de devis pour mariage et √©v√©nements sp√©ciaux"
                                onclick="openMailChoice(3, this.getAttribute('data-mail-subject'), event)">
                                Devis
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="card h-100 text-center">
                        <div class="card-body">
                            <h3 class="card-title">
                        PS : * D√©claration SACEM faite/pay√©e par l‚Äôassociation<span class="card-title-green"> 70‚Ç¨</span>
                            </h3>
                    </div>
                    <div class="col-12 col-md-3">
                    <div class="card h-100 text-center">
                        <div class="card-body">
                            <h3 class="card-title">
                        Il est n√©cessaire de pr√©voir une indemnit√© kilom√©trique pour les trajets d√©passant les <span class="card-title-km">15 kilom√®tres</span> autour de Toulon
                            </h3>
                    </div>
            <!-- Trois bandes horizontales rouges modifiables, m√™me √©paisseur -->
            <!-- Bande noire 1 (ligne horizontale d√©corative) -->
            <div id="bande-rouge-1" class="bande-rouge-fix"></div>
            <!-- Bande noire 2 (ligne horizontale d√©corative) -->
            <div id="bande-rouge-2" class="bande-rouge-fix"></div>
            <!-- Bande noire 3 (ligne horizontale d√©corative) -->
            <div id="bande-rouge-3" class="bande-rouge-fix"></div>
            <!-- Bande noire 4 (ligne horizontale d√©corative) -->
            <div id="bande-rouge-4" class="bande-rouge-fix"></div>
            <!-- Bande noire 5 (ligne horizontale d√©corative) -->
            <div id="bande-rouge-5" class="bande-rouge-fix"></div>
        </div>
    </div>
    <div class="container my-5 tarifs-container-fix">
        <h2 class="section-title mb-3 text-center">Membres de l'association</h2>
        <ul class="list-group list-group-flush text-start membres-list">
            <li class="list-group-item bg-transparent">Pr√©sident: Pascal SIBOUR <span class="membre-alias">(ted Winter)</span></li>
            <li class="list-group-item bg-transparent">Secr√©taire: Marion FROGER</li>
            <li class="list-group-item bg-transparent">Tr√©sorier: Franck VERCELLOTTI</li>
        </ul>
    </div>

    <!-- Modale Avis -->
    <div id="avisModal" class="avis-modal-bg-fix">
      <div class="avis-modal-content">
        <button id="closeAvisModal" class="avis-close-btn" aria-label="Fermer">&times;</button>
        <div class="avis-modal-header">
          <img src="https://cdn-icons-png.flaticon.com/512/616/616494.png" alt="Avis" class="avis-modal-icon">
          <h2 class="mb-2">Donnez votre avis</h2>
          <div class="avis-modal-subtitle">Votre retour nous aide √† progresser&nbsp;!</div>
        </div>
        <form id="avisForm">
          <div class="mb-2 avis-form-row">
            <input type="text" id="avisNom" name="avisNom" class="form-control avis-input" placeholder="Votre nom" required>
            <input type="email" id="avisMail" name="avisMail" class="form-control avis-input" placeholder="Votre e-mail" required>
          </div>
          <div class="mb-2 avis-form-row">
            <div class="avis-label">Qualit√© du spectacle</div>
            <div class="star-rating" data-note="note1"></div>
          </div>
          <div class="mb-2 avis-form-row">
            <div class="avis-label">Professionnalisme</div>
            <div class="star-rating" data-note="note2"></div>
          </div>
          <div class="mb-2 avis-form-row">
            <div class="avis-label">R√©activit√©</div>
            <div class="star-rating" data-note="note3"></div>
          </div>
          <div class="mb-2 avis-form-row">
            <textarea id="avisCommentaire" name="avisCommentaire" class="form-control avis-textarea" placeholder="Votre commentaire (optionnel)" rows="3"></textarea>
          </div>
          <button type="submit" class="btn btn-magic btn-lg avis-btn">Envoyer</button>
        </form>
        <div class="moyenne text-center mt-3 moyenne-hidden" id="moyenneStars"></div>
      </div>
    </div>
    <link rel="stylesheet" href="css/avis-fix.css">
    <style>
      /* Modale avis professionnelle */
      #avisModal {
        display: none;
        position: fixed;
        z-index: 3000;
        left: 0; top: 0;
        width: 100vw; height: 100vh;
        background: rgba(24,20,44,0.92);
        align-items: center;
        justify-content: center;
        animation: avis-fadein 0.3s;
      }
      @keyframes avis-fadein {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      .avis-modal-content {
        background: linear-gradient(135deg, #fff 0%, #f7e7ff 100%);
        border-radius: 1.5rem;
        box-shadow: 0 8px 32px #7c4dff55, 0 2px 8px #0002;
        max-width: 410px;
        width: 96%;
        margin: auto;
        padding: 2.2rem 1.5rem 1.5rem 1.5rem;
        position: relative;
        animation: avis-popin 0.4s cubic-bezier(.4,2,.6,1);
        display: flex;
        flex-direction: column;
        align-items: stretch;
      }
      @keyframes avis-popin {
        0% { transform: scale(0.85); opacity: 0; }
        100% { transform: scale(1); opacity: 1; }
      }
      .avis-modal-header {
        text-align: center;
        margin-bottom: 1.2rem;
      }
      .avis-modal-icon {
        width: 48px;
        height: 48px;
        margin-bottom: 0.3rem;
        filter: drop-shadow(0 2px 8px #ffd70088);
      }
      .avis-modal-header h2 {
        font-size: 1.6rem;
        color: #7c4dff;
        font-family: 'Cinzel Decorative', serif;
        margin-bottom: 0.2rem;
        letter-spacing: 1px;
      }
      .avis-modal-subtitle {
        font-size: 1.05rem;
        color: #381a5a;
        margin-bottom: 0.2rem;
        font-weight: 500;
      }
      .avis-close-btn {
        position: absolute;
        top: 14px; right: 18px;
        background: none;
        border: none;
        font-size: 2rem;
        color: #7c4dff;
        cursor: pointer;
        transition: color 0.2s;
        z-index: 10;
      }
      .avis-close-btn:hover {
        color: #ff2d2d;
      }
      .avis-form-row {
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
        margin-bottom: 0.7rem;
      }
      .avis-label {
        font-weight: bold;
        color: #2d1a3a;
        font-size: 1.08rem;
        margin-bottom: 0.1rem;
      }
      .avis-input, .avis-textarea {
        background: #f3eaff;
        border: 1.5px solid #7c4dff;
        color: #2d1a3a;
        border-radius: 0.7rem;
        padding: 0.5rem 0.9rem;
        font-size: 1.05rem;
        margin-bottom: 0.1rem;
        transition: border 0.2s, box-shadow 0.2s;
        /* Ajout pour forcer la couleur du texte lors de la saisie */
        caret-color: #181c2b;
      }
      .avis-input:focus, .avis-textarea:focus {
        border-color: #ffd700;
        box-shadow: 0 0 0 2px #ffd70044;
        outline: none;
        background: #fff;
        color: #181c2b; /* Texte noir lors de la saisie */
      }
      .avis-textarea {
        min-height: 60px;
        resize: vertical;
      }
      .avis-btn {
        margin-top: 0.5rem;
        width: 100%;
        font-size: 1.15rem !important;
        border-radius: 1.2rem;
        box-shadow: 0 2px 12px #ffd70033;
        font-weight: bold;
        letter-spacing: 1px;
      }
      .star-rating {
        font-size: 2rem;
        color: #ffd700;
        cursor: pointer;
        -webkit-user-select: none;
        user-select: none;
        margin-bottom: 0.1rem;
      }
      .star-rating .star {
        transition: color 0.2s, transform 0.15s;
        display: inline-block;
        margin-right: 2px;
      }
      .star-rating .star.inactive {
        color: #e0dcdc;
      }
      .star-rating .star:hover,
      .star-rating .star:focus {
        color: #ff2d2d;
        transform: scale(1.18);
      }
      #moyenneStars {
        font-size: 1.3rem;
        color: #ff9800;
        font-weight: bold;
        background: #fffbe7;
        border-radius: 0.7rem;
        padding: 0.7rem 0.5rem 0.5rem 0.5rem;
        margin-top: 0.7rem;
        box-shadow: 0 2px 8px #ffd70022;
      }
      @media (max-width: 575px) {
        .avis-modal-content {
          padding: 1.2rem 0.5rem 1rem 0.5rem;
        }
        .avis-modal-header h2 {
          font-size: 1.15rem;
        }
        .avis-modal-icon {
          width: 36px; height: 36px;
        }
      }
    </style>
    <script>
// Variable qui indique si l'utilisateur est connect√© (true = admin, false = spectateur)
let isLoggedIn = false;
let isAdmin = false;

// Met √† jour le bouton de connexion/d√©connexion dans la navbar selon l'√©tat de connexion
function updateNavbarLogin() {
    const navLoginBtn = document.getElementById('navLoginBtn');
    if (isLoggedIn && isAdmin) {
        navLoginBtn.textContent = 'Admin - D√©connexion'; // Change le texte du bouton
        navLoginBtn.href = '#'; // Emp√™che la navigation
        navLoginBtn.onclick = function(e) {
            e.preventDefault();
            // Utilise la fonction centralis√©e de d√©connexion
            if (typeof performLogout === 'function') {
                performLogout();
            } else {
                // Fallback am√©lior√©
                console.log('‚ö†Ô∏è performLogout not found, using fallback');
                fetch('/api/logout', { method: 'POST', credentials: 'include' })
                    .then(() => {
                        localStorage.removeItem('token');
                        sessionStorage.clear();
                        isLoggedIn = false;
                        avatarTW.style.display = 'none';
                        avatarMenu.style.display = 'none';
                        updateNavbarLogin();
                        window.location.href = 'index.html';
                    })
                    .catch(error => {
                        console.error('Erreur lors de la d√©connexion:', error);
                        // Force la d√©connexion m√™me en cas d'erreur
                        localStorage.removeItem('token');
                        window.location.href = 'index.html';
                    });
            }
        };
    } else {
        navLoginBtn.textContent = 'Spectateur - Se connecter'; // Affiche "Spectateur" si non connect√©
        navLoginBtn.href = 'login.html'; // Redirige vers la page de connexion
        navLoginBtn.onclick = null;
    }
}

// Affichage du menu utilisateur (avatar) au survol ou au clic
const avatarTW = document.getElementById('avatarTW'); // Le rond "TW" en haut de la page
const avatarMenu = document.getElementById('avatarMenu'); // Le menu qui s'affiche au survol ou au clic
let avatarMenuTimeout = null; // Timer pour masquer le menu apr√®s 5 secondes

// Affiche le menu quand la souris passe sur le rond
avatarTW.addEventListener('mouseenter', () => {
    avatarMenu.style.display = 'flex';
});
// Masque le menu quand la souris quitte le rond (sauf si elle va sur le menu)
avatarTW.addEventListener('mouseleave', () => {
    setTimeout(() => {
        if (!avatarMenu.matches(':hover')) avatarMenu.style.display = 'none';
    }, 100);
});
// Masque le menu quand la souris quitte le menu
avatarMenu.addEventListener('mouseleave', () => {
    avatarMenu.style.display = 'none';
});
// Garde le menu affich√© si la souris est dessus
avatarMenu.addEventListener('mouseenter', () => {
    avatarMenu.style.display = 'flex';
});

// Affiche le menu pendant 5 secondes si on clique sur le rond
avatarTW.addEventListener('click', () => {
    avatarMenu.style.display = 'flex';
    if (avatarMenuTimeout) clearTimeout(avatarMenuTimeout);
    avatarMenuTimeout = setTimeout(() => {
        avatarMenu.style.display = 'none';
    }, 5000);
});

// D√©connexion via le bouton du menu utilisateur : utilise la fonction centralis√©e
document.getElementById('btnLogout').addEventListener('click', function() {
    if (typeof performLogout === 'function') {
        performLogout();
    } else {
        // Fallback am√©lior√©
        console.log('‚ö†Ô∏è performLogout not found, using fallback');
        fetch('/api/logout', { method: 'POST', credentials: 'include' })
            .then(() => {
                localStorage.removeItem('token');
                sessionStorage.clear();
                isLoggedIn = false;
                avatarTW.style.display = 'none';
                avatarMenu.style.display = 'none';
                updateNavbarLogin();
                window.location.href = 'index.html';
            })
            .catch(error => {
                console.error('Erreur lors de la d√©connexion:', error);
                localStorage.removeItem('token');
                window.location.href = 'index.html';
            });
    }
});

// Au chargement de la page, v√©rifie la session pour d√©terminer le r√¥le (admin/spectateur)
window.addEventListener('DOMContentLoaded', function() {
    console.log('üîç V√©rification du statut utilisateur...');
    
    // 1. V√©rifie le localStorage pour la session
    const sessionToken = localStorage.getItem('sessionToken');
    const storedIsAdmin = localStorage.getItem('is_admin');
    const storedIsLoggedIn = localStorage.getItem('isLoggedIn');
    
    if (sessionToken && storedIsLoggedIn === 'true') {
        // Utilisateur connect√© = Administrateur
        isLoggedIn = true;
        isAdmin = storedIsAdmin === 'true';
        console.log('‚úÖ Session administrateur d√©tect√©e');
        
        // Affiche l'interface admin
        avatarTW.style.display = 'block';
        document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'block');
        
        // Met √† jour le nom d'utilisateur si disponible
        const userName = localStorage.getItem('user_nom');
        if (userName) {
            console.log(`üë§ Connect√© en tant que: ${userName}`);
        }
    } else {
        // Utilisateur non connect√© = Spectateur
        isLoggedIn = false;
        isAdmin = false;
        console.log('üëÅÔ∏è Mode spectateur activ√©');
        
        // Cache l'interface admin
        avatarTW.style.display = 'none';
        document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'none');
    }
    
    // Met √† jour l'interface
    updateNavbarLogin();
    avatarMenu.style.display = 'none';
    
    console.log(`üìä √âtat final: isLoggedIn=${isLoggedIn}, isAdmin=${isAdmin}`);
});

// Gestion modale Devis pour tous les boutons "Devis"
function openDevisModal(event) {
    event.preventDefault();
    document.getElementById('devisModal').style.display = 'block';
    updateDevisLinks();
}
function closeDevisModal() {
    document.getElementById('devisModal').style.display = 'none';
}
document.getElementById('closeDevisModal').onclick = closeDevisModal;

function updateDevisLinks() {
    const prestation = document.getElementById('prestationSelect').options[document.getElementById('prestationSelect').selectedIndex].text;
    const subject = encodeURIComponent('Demande de devis : ' + prestation);
    const gmailLink = `https://mail.google.com/mail/?view=cm&fs=1&to=contact@magicpscare.fr&su=${subject}`;
    const outlookLink = `https://outlook.live.com/mail/0/deeplink/compose?to=contact@magicpscare.fr&subject=${subject}`;
    document.getElementById('gmailDevisBtn').href = gmailLink;
    document.getElementById('outlookDevisBtn').href = outlookLink;
}
document.getElementById('prestationSelect').addEventListener('change', updateDevisLinks);

document.querySelectorAll('.btn-devis, .btn-devis-mailto').forEach(btn => {
    btn.addEventListener('click', openDevisModal);
});

window.addEventListener('click', function(e) {
    const modal = document.getElementById('devisModal');
    const modalContent = document.getElementById('devisModalContent');
    if (modal.style.display === 'block' && !modalContent.contains(e.target) && e.target.className.indexOf('btn-devis') === -1 && e.target.className.indexOf('btn-devis-mailto') === -1) {
        modal.style.display = 'none';
    }
});
    </script>
    <!-- Script principal pour la d√©connexion centralis√©e -->
    <script src="script.js"></script>
    <!-- Scripts de configuration API et monitoring -->
    <script src="js/api-config.js"></script>
    <script src="js/deployment-monitor.js"></script>
    
    <footer class="footer text-center py-4 footer-fix">
        <div class="container">
            <small>&copy; 2024 PS Care ‚Äì Association de Magie. Tous droits r√©serv√©s.</small>
        </div>
    </footer>
</body>
</html>
